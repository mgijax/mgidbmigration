Tue Mar 17 14:07:21 EDT 2020
select m.symbol, a.accid, substring(t.term,1,30) as term, u.orcid, e.*
into temp table toAdd
from voc_annot v, voc_evidence e, mgi_user u, mrk_marker m, acc_accession a, voc_term t
where v._annottype_key = 1000
and v._annot_key = e._annot_key
and e._createdby_key = u._user_key and u.orcid is not null
and v._object_key = m._marker_key
and v._term_key = a._object_key
and a._mgitype_key = 13
and a.preferred = 1
and v._term_key = t._term_key
and not exists (select 1 from voc_evidence_property p
where e._annotevidence_key = p._annotevidence_key
and p._propertyterm_key not in (16583062))
union
select m.symbol, a.accid, substring(t.term,1,30) as term, u.orcid, e.*
from voc_annot v, voc_evidence e, mgi_user u, mrk_marker m, acc_accession a, voc_term t
where v._annottype_key = 1000
and v._annot_key = e._annot_key
and e._modifiedby_key = u._user_key and u.orcid is not null
and v._object_key = m._marker_key
and v._term_key = a._object_key
and a._mgitype_key = 13
and a.preferred = 1
and v._term_key = t._term_key
and not exists (select 1 from voc_evidence_property p
where e._annotevidence_key = p._annotevidence_key
and p._propertyterm_key not in (16583062))
;
SELECT 35577
select last_value from voc_evidence_property_seq;
 last_value 
------------
  930805768
(1 row)

insert into voc_evidence_property
select nextval('voc_evidence_property_seq'), _annotevidence_key, 18583062, 1, 5, orcid, _createdby_key, _modifiedby_key
from toAdd
;
INSERT 0 35577
select last_value from voc_evidence_property_seq;
 last_value 
------------
  930841345
(1 row)

Tue Mar 17 14:07:25 EDT 2020
